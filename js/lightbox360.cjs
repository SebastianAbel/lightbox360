/*
 http://creativecommons.org/licenses/by/2.5/
 - Free for use in both personal and commercial projects
 - Attribution requires leaving author name, author link, and the license info intact
*/
(function(){var c=jQuery,x=function(){function c(){this.la=500;this.Ca=!0;this.ja=700;this.oa=50;this.La=!0;this.na=this.Aa=!1}c.prototype.za=function(a,b){return"Image "+a+" of "+b};return c}(),B=function(){function d(a){this.options=a;this.ea=[];this.fa=void 0;this.init()}d.prototype.init=function(){this.enable();this.Ba()};d.prototype.enable=function(){var a=this;c("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(b){a.start(c(b.currentTarget));
return!1})};d.prototype.Ba=function(){var a=this;c("<div id='lightboxOverlay' class='lightboxOverlay'></div><div id='lightbox' class='lightbox'><div class='lb-outerContainer'><div class='lb-container'><canvas id='pano-canvas' class='lb-canvas' /><img class='lb-image' src='' /><div class='lb-nav'><a class='lb-prev' href='' ></a><a class='lb-next' href='' ></a></div><div class='lb-pano_nav'><a class='lb-pano_prev' href='' ></a><a class='lb-pano_next' href='' ></a></div><div class='lb-pano_control'><a class='lb-pano_full' href='' ></a><a class='lb-pano_full_back' href='' ></a></div><div class='lb-loader'><a class='lb-cancel'></a></div></div></div><div class='lb-dataContainer'><div class='lb-data'><div class='lb-details'><span class='lb-caption'></span><span class='lb-number'></span></div><div class='lb-closeContainer'><a class='lb-close'></a></div></div></div></div>").appendTo(c("body"));
this.ca=c("#lightbox");this.ka=c("#lightboxOverlay");this.da=this.ca.find(".lb-outerContainer");this.ia=this.ca.find(".lb-container");this.ta=parseInt(this.ia.css("padding-top"),10);this.sa=parseInt(this.ia.css("padding-right"),10);this.qa=parseInt(this.ia.css("padding-bottom"),10);this.ra=parseInt(this.ia.css("padding-left"),10);this.ka.hide().on("click",function(){a.end();return!1});this.ca.hide().on("click",function(b){"lightbox"===c(b.target).attr("id")&&a.end();return!1});this.da.on("click",
function(b){"lightbox"===c(b.target).attr("id")&&a.end();return!1});this.ca.find(".lb-prev").on("click",function(){0===a.fa?a.ha(a.ea.length-1):a.ha(a.fa-1);return!1});this.ca.find(".lb-next").on("click",function(){a.fa===a.ea.length-1?a.ha(0):a.ha(a.fa+1);return!1});this.ca.find(".lb-pano_prev").on("click",function(){0===a.fa?a.ha(a.ea.length-1):a.ha(a.fa-1);return!1});this.ca.find(".lb-pano_next").on("click",function(){a.fa===a.ea.length-1?a.ha(0):a.ha(a.fa+1);return!1});this.ca.find(".lb-loader, .lb-close").on("click",
function(){a.end();return!1});this.ca.find(".lb-pano_full").on("click",function(){a.Ga();return!1});this.ca.find(".lb-pano_full_back").on("click",function(){a.Ha();return!1});this.Ja=this.ca.find(".lb-canvas").width();this.Ia=this.ca.find(".lb-canvas").height();this.ca.find(".lb-canvas").width("auto");this.ca.find(".lb-canvas").height("auto")};d.prototype.start=function(a){function b(a){d.ea.push({link:a.attr("href"),title:a.attr("data-title")||a.attr("title"),wa:a.attr("pano-type")})}var d=this,
e=c(window);e.on("resize",c.proxy(this.ma,this));c("select, object, embed").css({visibility:"hidden"});this.ma();this.ea=[];var g=0,f=a.attr("data-lightbox");if(f)for(var f=c(a.prop("tagName")+'[data-lightbox="'+f+'"]'),k=0;k<f.length;k=++k)b(c(f[k])),f[k]===a[0]&&(g=k);else if("lightbox"===a.attr("rel"))b(a);else for(f=c(a.prop("tagName")+'[rel="'+a.attr("rel")+'"]'),k=0;k<f.length;k=++k)b(c(f[k])),f[k]===a[0]&&(g=k);a=e.scrollTop()+this.options.oa;e=e.scrollLeft();this.ca.css({top:a+"px",left:e+
"px"}).fadeIn(this.options.la);this.ha(g)};d.prototype.ha=function(a){var b=this;this.ua();var d=this.ca.find(".lb-image");this.ka.fadeIn(this.options.la);c(".lb-loader").fadeIn("slow");this.ca.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide();this.ca.find(".lb-canvas, .lb-pano_nav, .lb-pano_prev, .lb-pano_next, .lb-pano_control, .lb-pano_full, .lb-pano_full_back").hide();this.da.addClass("animating");var e=new Image;e.onload=function(){var g,f;d.attr("src",
b.ea[a].link);c(e);null!=b.ea[a].wa&&(null==b.ga&&(b.ga=new Pano,b.ga.init(b.ca.find(".lb-canvas").get(0))),b.ga.isAvailable()&&(e.width=b.Ja,e.height=b.Ia));d.width(e.width);d.height(e.height);b.options.Ca&&(g=c(window).width(),f=c(window).height(),g=g-b.ra-b.sa-20,f=f-b.ta-b.qa-120,e.width>g||e.height>f)&&(e.width/g>e.height/f?(f=g,g=parseInt(e.height/(e.width/f),10)):(g=f,f=parseInt(e.width/(e.height/g),10)),d.width(f),d.height(g));b.Na(d.width(),d.height())};e.src=this.ea[a].link;this.fa=a};d.prototype.ma=
function(){this.ka.width(c(window).width()).height(c(document).height())};d.prototype.Na=function(a,b){function d(){e.ca.find(".lb-dataContainer").width(k);e.ca.find(".lb-prevLink").height(m);e.ca.find(".lb-nextLink").height(m);null!=e.ea[e.fa].wa&&e.ga.isAvailable()?e.Ma(a,b):e.Ka()}var e=this,g=this.da.outerWidth(),f=this.da.outerHeight(),k=a+this.ra+this.sa,m=b+this.ta+this.qa;if(this.pa){this.ca.addClass("animating");var x=c(window).scrollTop()+this.options.oa;this.ca.animate({top:x+"px"},this.options.ja,
"swing",function(){e.ca.removeClass("animating");e.pa=!1})}g!==k||f!==m?this.da.animate({width:k,height:m},this.options.ja,"swing",function(){d()}):d()};d.prototype.Ka=function(){this.ca.find(".lb-loader").hide();this.ca.find(".lb-image").fadeIn("slow");this.Oa();this.ya();this.xa();this.va()};d.prototype.Ma=function(a,b){this.ca.find(".lb-loader").hide();this.ca.find(".lb-canvas").fadeIn("slow");this.Pa();this.ya();this.xa();this.va();this.ca.find(".lb-canvas").get(0).width=a;this.ca.find(".lb-canvas").get(0).height=
b;this.ga.setSize(a,b);var c=this.ca.find(".lb-image");this.ga.setImage(c.get(0))};d.prototype.Oa=function(){var a=!1;try{document.createEvent("TouchEvent"),a=this.options.Aa?!0:!1}catch(b){}this.ca.find(".lb-nav").show();1<this.ea.length&&(this.options.na?(a&&this.ca.find(".lb-prev, .lb-next").css("opacity","1"),this.ca.find(".lb-prev, .lb-next").show()):(0<this.fa&&(this.ca.find(".lb-prev").show(),a&&this.ca.find(".lb-prev").css("opacity","1")),this.fa<this.ea.length-1&&(this.ca.find(".lb-next").show(),
a&&this.ca.find(".lb-next").css("opacity","1"))))};d.prototype.Pa=function(){this.ca.find(".lb-pano_nav").show();this.ca.find(".lb-pano_control").show();this.ca.find(".lb-pano_full").show();this.ca.find(".lb-pano_full").css("opacity","1");1<this.ea.length&&(this.options.na?(this.ca.find(".lb-pano_prev, .lb-pano_next").css("opacity","1"),this.ca.find(".lb-pano_prev, .lb-pano_next").show()):(0<this.fa&&(this.ca.find(".lb-pano_prev").show(),this.ca.find(".lb-pano_prev").css("opacity","1")),this.fa<this.ea.length-
1&&(this.ca.find(".lb-pano_next").show(),this.ca.find(".lb-pano_next").css("opacity","1"))))};d.prototype.ya=function(){var a=this;if("undefined"!==typeof this.ea[this.fa].title&&""!==this.ea[this.fa].title)this.ca.find(".lb-caption").html(this.ea[this.fa].title).fadeIn("fast").find("a").on("click",function(){location.href=c(this).attr("href")});1<this.ea.length&&this.options.La?this.ca.find(".lb-number").text(this.options.za(this.fa+1,this.ea.length)).fadeIn("fast"):this.ca.find(".lb-number").hide();
this.da.removeClass("animating");this.ca.find(".lb-dataContainer").fadeIn(this.options.ja,function(){return a.ma()})};d.prototype.xa=function(){this.ea.length>this.fa+1&&((new Image).src=this.ea[this.fa+1].link);0<this.fa&&((new Image).src=this.ea[this.fa-1].link)};d.prototype.va=function(){c(document).on("keyup.keyboard",c.proxy(this.Da,this))};d.prototype.ua=function(){c(document).off(".keyboard")};d.prototype.Da=function(a){a=a.keyCode;var b=String.fromCharCode(a).toLowerCase();if(27===a||b.match(/x|o|c/))this.end();
else if("p"===b||37===a)0!==this.fa?this.ha(this.fa-1):this.options.na&&1<this.ea.length&&this.ha(this.ea.length-1);else if("n"===b||39===a)this.fa!==this.ea.length-1?this.ha(this.fa+1):this.options.na&&1<this.ea.length&&this.ha(0)};d.prototype.end=function(){this.ua();c(window).off("resize",this.ma);this.ca.fadeOut(this.options.la);this.ka.fadeOut(this.options.la);c("select, object, embed").css({visibility:"visible"})};d.prototype.Ga=function(){var a=this;if(null!=this.ga&&!this.ga.fullscreen()){a.ca.find(".lb-pano_full").hide();
c("body").css({overflow:"hidden"});this.ca.addClass("animating");var b=c(window).scrollTop();this.pa=!0;this.ca.animate({top:b+"px"},this.options.ja,"swing",function(){a.ca.removeClass("animating")});var d=a.da.width()-a.ia.width(),e=a.da.height()-a.ia.height(),g=setInterval(function(){var b=a.da.width()-d,c=a.da.height()-e;a.ga.setSize(b,c)},1E3/60);this.Fa=a.da.width();this.Ea=a.da.height();this.da.addClass("animating");this.da.animate({width:window.innerWidth,height:window.innerHeight},this.options.ja,
"swing",function(){a.da.removeClass("animating");clearInterval(g);a.ga.setSize(a.da.width()-d,a.da.height()-e);a.ca.find(".lb-pano_full_back").show();a.ca.find(".lb-pano_full_back").css("opacity","1")})}};d.prototype.Ha=function(){var a=this;if(null!=this.ga&&!this.ga.fullscreen()){a.ca.find(".lb-pano_full_back").hide();this.ca.addClass("animating");var b=c(window).scrollTop()+this.options.oa;this.ca.animate({top:b+"px"},this.options.ja,"swing",function(){a.ca.removeClass("animating");a.pa=!1});var d=
a.da.width()-a.ia.width(),e=a.da.height()-a.ia.height(),g=setInterval(function(){var b=a.da.width()-d,c=a.da.height()-e;a.ga.setSize(b,c)},1E3/60);this.da.addClass("animating");this.da.animate({width:this.Fa,height:this.Ea},this.options.ja,"swing",function(){a.da.removeClass("animating");clearInterval(g);a.ga.setSize(a.da.width()-d,a.da.height()-e);a.ca.find(".lb-pano_full").show();a.ca.find(".lb-pano_full").css("opacity","1");c("body").css({overflow:"auto"})})}};return d}();c(function(){var c=new x;
new B(c)})}).call(this);
