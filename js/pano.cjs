var g;function l(){this.L=40;this.b=this.o=30+90*(1-this.L/100);this.S=mat4.create();this.T=mat4.create();this.v=null}g=l.prototype;
g.X=function(a){var b=this;this.canvas=a;try{this.a=a.getContext("experimental-webgl"),this.U(a.width,a.height)}catch(c){this.P=!1;return}this.P=!0;this.a.clearColor(1,0,1,1);this.a.enable(this.a.DEPTH_TEST);this.b=this.a.A/this.a.B*this.o*1;this.H=new m(this.a);this.f=new p(a,this);this.f.b=this.b;this.ja=new q(this.a);var d=new r(this.a);t(d,function(){var a;a=d.a.createShader(d.a.VERTEX_SHADER);d.a.shaderSource(a,d.C[0]);d.a.compileShader(a);if(d.a.getShaderParameter(a,d.a.COMPILE_STATUS)){var c=
d.a.createShader(d.a.FRAGMENT_SHADER);d.a.shaderSource(c,d.C[1]);d.a.compileShader(c);d.a.getShaderParameter(c,d.a.COMPILE_STATUS)?(shaderPgm=d.a.createProgram(),d.a.attachShader(shaderPgm,a),d.a.attachShader(shaderPgm,c),d.a.linkProgram(shaderPgm),d.a.getProgramParameter(shaderPgm,d.a.LINK_STATUS)||alert("Unable to initialize the shader program."),shaderPgm.W=d.a.getAttribLocation(shaderPgm,"aVertexPosition"),d.a.enableVertexAttribArray(shaderPgm.W),shaderPgm.V=d.a.getAttribLocation(shaderPgm,"aTextureCoord"),
d.a.enableVertexAttribArray(shaderPgm.V),shaderPgm.ga=d.a.getUniformLocation(shaderPgm,"uPMatrix"),shaderPgm.fa=d.a.getUniformLocation(shaderPgm,"uMVMatrix"),a=shaderPgm):(alert(d.a.getShaderInfoLog(c)),a=null)}else alert(d.a.getShaderInfoLog(a)),a=null;b.u=a;u(b)})};g.ea=function(){return this.P};g.U=function(a,b){this.width=a;this.height=b;this.canvas.width=a;this.canvas.height=b;this.a.B=a;this.a.A=b;this.b=this.a.A/this.a.B*this.o*1;null!=this.f&&(this.f.b=this.b);u(this)};
g.ha=function(a){var b=this;this.v=null;this.N(this.L);this.f.b=this.b;b.f.reset();v(this.H,a,function(a){b.v=a;u(b)})};g.ia=function(a,b){b="undefined"!==typeof b?b:15;var c=this;this.v=null;this.N(this.L);this.f.b=this.b;c.f.reset();w(this.H,a,b,function(a){c.v=a;u(c)})};g.ca=function(){return null!=this.H.K};g.Y=function(){var a=this.H;null!=a.K&&(clearInterval(a.K),a.K=null,a.h.get(0).pause(),a.h.attr("src",null))};
g.N=function(a){this.o=30+90*(1-a/100);this.b=this.a.A/this.a.B*this.o*1;this.f.b=this.b;u(this)};g.ba=function(){return-100*((this.o-30)/90-1)};
function u(a){if(null!=a.u&&(a.a.viewport(0,0,a.a.B,a.a.A),a.a.clear(a.a.COLOR_BUFFER_BIT|a.a.DEPTH_BUFFER_BIT),null!=a.v)){mat4.perspective(a.b,a.a.B/a.a.A,.1,10,a.T);var b=a.f;mat4.multiply(b.O,b.s,a.S);a.a.useProgram(a.u);a.a.activeTexture(a.a.TEXTURE0);a.a.bindTexture(a.a.TEXTURE_2D,a.v);a.a.uniform1i(a.a.getUniformLocation(a.u,"uSampler"),0);a.a.uniformMatrix4fv(a.u.ga,!1,a.T);a.a.uniformMatrix4fv(a.u.fa,!1,a.S);b=a.ja;a=a.u;b.a.bindBuffer(b.a.ARRAY_BUFFER,b.w);b.a.vertexAttribPointer(a.W,b.w.R,
b.a.FLOAT,!1,0,0);b.a.bindBuffer(b.a.ARRAY_BUFFER,b.J);b.a.vertexAttribPointer(a.V,2,b.a.FLOAT,!1,0,0);b.a.bindBuffer(b.a.ELEMENT_ARRAY_BUFFER,b.I);b.a.drawElements(b.a.TRIANGLES,b.I.M,b.a.UNSIGNED_SHORT,0)}}g.aa=function(){return!1};window.Pano=l;l.prototype.isAvailable=l.prototype.ea;l.prototype.init=l.prototype.X;l.prototype.setSize=l.prototype.U;l.prototype.setImage=l.prototype.ha;l.prototype.fullscreen=l.prototype.aa;l.prototype.setFovScale=l.prototype.N;l.prototype.getFovScale=l.prototype.ba;
l.prototype.setVideo=l.prototype.ia;l.prototype.hasVideo=l.prototype.ca;l.prototype.clearVideo=l.prototype.Y;function q(a){this.a=a;for(var b=[],c=[],d=[],e=0,f=0;33>e;e++)for(var h=Math.sin(e*Math.PI/32),n=Math.cos(e*Math.PI/32),k=0;33>k;k++,f++){var A=Math.cos(2*k*Math.PI/32);b[3*f+0]=Math.sin(2*k*Math.PI/32)*h;b[3*f+1]=n;b[3*f+2]=A*h;d[2*f+0]=1-k/32;d[2*f+1]=e/32}for(f=e=0;32>e;e++)for(k=0;32>k;k++,f++)c[6*f+0]=33*e+k,c[6*f+1]=33*e+(k+1),c[6*f+2]=33*(e+1)+k,c[6*f+3]=33*e+(k+1),c[6*f+4]=33*(e+1)+(k+1),c[6*f+5]=33*(e+1)+k;this.w=this.a.createBuffer();this.a.bindBuffer(a.ARRAY_BUFFER,this.w);this.a.bufferData(a.ARRAY_BUFFER,
new Float32Array(b),this.a.STATIC_DRAW);this.w.R=3;this.w.M=1089;this.J=this.a.createBuffer();this.a.bindBuffer(a.ARRAY_BUFFER,this.J);this.a.bufferData(a.ARRAY_BUFFER,new Float32Array(d),this.a.STATIC_DRAW);this.J.R=2;this.J.M=1089;this.I=a.createBuffer();this.a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.I);this.a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),this.a.STATIC_DRAW);this.I.M=6144};function r(a){this.a=a;this.ka="shaders/unlit_texture.vs";this.Z="shaders/unlit_texture.fs";this.C=[null,null]}function t(a,b){x([a.ka,a.Z],function(c){a.C[0]=c[0];a.C[1]=c[1];b()},function(a){alert('Failed to download "'+a+'"')})};function x(a,b,c){function d(a,c){h[c]=a;f++;f==e&&b(h)}for(var e=a.length,f=0,h=[],n=0;n<e;n++)y(a[n],n,d,c)}function y(a,b,c,d){var e=new XMLHttpRequest;e.open("GET",a,!0);e.onreadystatechange=function(){4==e.readyState&&(200==e.status?c(e.responseText,b):d(a))};e.send(null)};function m(a){this.a=a;this.da=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;this.h=$("<video></video>");this.h.hide()}function v(a,b,c){z(a,b,a.a.createTexture(),c)}function w(a,b,c,d){var e=a.a.createTexture();a.h.attr("src",b);a.h.attr("loop",!0);a.h.get(0).play();a.K=setInterval(function(){src=a.h.get(0);z(a,src,e,d)},1E3/c)}
function z(a,b,c,d){function e(a){return 0==(a&a-1)}function f(a){--a;for(var b=1;32>b;b<<=1)a=a|a>>b;return a+1}a.a.bindTexture(a.a.TEXTURE_2D,c);if(a.da&&(!e(b.width)||!e(b.height))){var h=document.createElement("canvas");for(h.width=f(b.width);2048<h.width;)h.width/=2;for(h.height=f(b.height);2048<h.height;)h.height/=2;h.getContext("2d").drawImage(b,0,0,h.width,h.height);b=h}a.a.texImage2D(a.a.TEXTURE_2D,0,a.a.RGBA,a.a.RGBA,a.a.UNSIGNED_BYTE,b);a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_MAG_FILTER,
a.a.LINEAR);a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_MIN_FILTER,a.a.LINEAR);a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_WRAP_S,a.a.CLAMP_TO_EDGE);a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_WRAP_T,a.a.CLAMP_TO_EDGE);a.a.bindTexture(a.a.TEXTURE_2D,null);null!=d&&d(c)};function p(a,b){var c=this;this.j=!1;this.O=mat4.create();mat4.identity(this.O);mat4.translate(this.O,[0,0,0]);this.s=mat4.create();mat4.identity(this.s);this.D;this.F;this.b=this.c=this.i=this.m=this.l=0;this.G=b;this.canvas=a;this.canvas.addEventListener("mousedown",function(a){c.j=!0;null!=c.g&&(clearInterval(c.g),c.g=null);var b=c.canvas.getBoundingClientRect(),f=800/c.canvas.width,h=(a.clientY-b.top)*f;c.D=(a.clientX-b.left)*f;c.F=h},!0);this.canvas.addEventListener("mousemove",function(a){if(c.j){var b=
c.canvas.getBoundingClientRect(),f=800/c.canvas.width;B(c,(a.clientX-b.left)*f,(a.clientY-b.top)*f);u(c.G)}},!0);this.canvas.addEventListener("mouseup",function(){c.j=!1;c.g=setInterval(function(){C(c);u(c.G)},1E3/60)},!0);this.canvas.addEventListener("touchstart",function(a){a.preventDefault();c.j=!0;null!=c.g&&(clearInterval(c.g),c.g=null);var b=c.canvas.getBoundingClientRect(),f=800/c.canvas.width,h=(a.targetTouches[0].pageY-b.top)*f;c.D=(a.targetTouches[0].pageX-b.left)*f;c.F=h},!0);this.canvas.addEventListener("touchmove",
function(a){a.preventDefault();if(c.j){var b=c.canvas.getBoundingClientRect(),f=800/c.canvas.width;B(c,(a.targetTouches[0].pageX-b.left)*f,(a.targetTouches[0].pageY-b.top)*f);u(c.G)}},!0);this.canvas.addEventListener("touchend",function(){c.j=!1;c.g=setInterval(function(){C(c);u(c.G)},1E3/60)},!0)}p.prototype.reset=function(){this.c=this.i=this.m=this.l=0;this.s=mat4.create();mat4.identity(this.s)};
function B(a,b,c){var d=a.D-b,e=a.F-c;a.D=b;a.F=c;a.l=d;a.m=e;b=.25*a.b/90;a.i+=d*b;a.c+=e*b;90<a.c?a.c=90:-90>a.c&&(a.c=-90);d=mat4.create();mat4.identity(d);mat4.rotate(d,a.c*Math.PI/180,[1,0,0]);mat4.rotate(d,a.i*Math.PI/180,[0,1,0]);a.s=d}
function C(a){a.l*=.95;a.m*=.95;.01>Math.abs(a.l)&&.01>Math.abs(a.m)&&(clearInterval(a.g),a.g=null);var b=a.m,c=.25*a.b/90;a.i+=a.l*c;a.c+=b*c;90<a.c?a.c=90:-90>a.c&&(a.c=-90);b=mat4.create();mat4.identity(b);mat4.rotate(b,a.c*Math.PI/180,[1,0,0]);mat4.rotate(b,a.i*Math.PI/180,[0,1,0]);a.s=b};
